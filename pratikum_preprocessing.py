# -*- coding: utf-8 -*-
"""Pratikum Preprocessing.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ssHY2G-2DY8fp-PHTqUBDAqB5hYQORI6

#  Pratikum Preprocessing: [Movie Dataset]
- **Nama:** [Kinanti Anggraeni]
- **NIM:** [4112322010]
- **Pertemuan:** [Minggu ke-3]

Import library
"""

import numpy as np
import pandas as pd

"""1.	Memuat Data"""

!wget https://raw.githubusercontent.com/kinantianggraeni/Movie-dataset/refs/heads/main/movie_sample_dataset.csv

"""2.	Memeriksa Data"""

movie_df = pd.read_csv("movie_sample_dataset.csv")
movie_df.head()

"""3.	Membersihkan Data"""

# 1. Hapus baris yang memiliki nilai NaN di kolom 'gross' dan 'budget'
movie_df.dropna(subset=['gross', 'budget'], inplace=True)

# 2. Atasi bagian yang tidak konsisten atau kesalahan penulisan di kolom, dengan mengubah nilai di kolom 'color' menjadi huruf kecil
movie_df['color'] = movie_df['color'].str.lower().str.strip()  # Mengubah menjadi huruf kecil dan menghapus spasi

# 3. Ubah atau hapus nilai-nilai yang tidak standar, seperti nilai negatif atau 'N/A'
movie_df = movie_df[movie_df['gross'] >= 0]  # Menghapus nilai negatif di kolom 'gross'
movie_df = movie_df[movie_df['budget'] >= 0]  # Menghapus nilai negatif di kolom 'budget'

# Menghapus nilai 'N/A'
movie_df.replace('N/A', pd.NA, inplace=True)  # Mengganti 'N/A' dengan NaN
movie_df.dropna(inplace=True)  # Hapus baris yang masih mengandung NaN

# Menampilkan data yang sudah dibersihkan
print(movie_df)  # Menampilkan dataframe di konsol

# Simpan dataframe yang sudah dibersihkan
movie_df.to_csv('data_file_cleaned.csv', index=False)

movie_df.head()

#memeriksa nilai yang hilang (missing values)
print(movie_df.isnull().sum())

movie_df.dtypes

"""4.	Transformasi Data"""

#mengubah tipe data yang diperlukan
# Mengubah kolom yang cocok menjadi kategorikal
movie_df['color'] = movie_df['color'].astype('category')
movie_df['director_name'] = movie_df['director_name'].astype('category')
movie_df['genres'] = movie_df['genres'].astype('category')
movie_df['language'] = movie_df['language'].astype('category')
movie_df['country'] = movie_df['country'].astype('category')

#Menampilkan data setelah kolom diubah
movie_df.dtypes

"""5.	Penyimpanan Data"""

# Simpan dataframe yang sudah dibersihkan ke file CSV baru
output_file = 'movie_dataset_cleaned.csv'
movie_df.to_csv(output_file, index=False)